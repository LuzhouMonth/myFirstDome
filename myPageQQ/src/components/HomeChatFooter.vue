<template>
    <div class="chat-footer">
        <form>
            <div class="form-row">
                <div class="col">
                    <div class="input-group">
                        <div class="input-group-prepend mr-sm-2 mr-1">
                            <div class="dropdown">
                                <button class="btn btn-secondary btn-icon btn-minimal btn-sm" type="button"
                                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <svg class="hw-20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                              d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                </button>
                                <div class="dropdown-menu">
                                    <div class="item">
                                        <label for="sendPic" style="display: inline;">
                                            <a class="dropdown-item">
                                                <svg class="hw-20 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                          d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                                </svg>
                                                <span>å›¾ç‰‡</span>
                                            </a>
                                        </label>
                                        <input id="sendPic" name="sendPic" type="file" style="display: none;">
                                    </div>

                                    <div class="item">
                                        <label for="sendPic" style="display: inline;">
                                            <a class="dropdown-item">
                                                <svg class="hw-20 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                          d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
                                                </svg>
                                                <span>æ–‡ä»¶</span>
                                            </a>
                                        </label>
                                        <input id="sendPic" name="sendPic" type="file" style="display: none;">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- è¡¨æƒ…ç¬¦å·æŒ‰é’® -->
                        <div class="input-group-prepend mr-sm-2 mr-1">
                            <button @click="emojiShow=!emojiShow" class="btn btn-secondary btn-icon btn-minimal btn-sm" type="button">
                                <svg class="hw-20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                            </button>
                        </div>

                        <!-- æ·»åŠ è¡¨æƒ…é¢æ¿ -->
                        <div v-if="emojiShow" class="chat-emoji">
                            <ul class="emoji-list">
                                <!-- ä¸€ä¸ªliå°±æ˜¯ä¸€ä¸ªè¡¨æƒ…ç¬¦å·ï¼Œæ•…è¦åœ¨emojiListä¸­éå†æ‰€æœ‰è¡¨æƒ… -->
                                <li v-for="(el,index) in emojiList" :key="index" @click="emojiSelectHandle(el)" class="emoji-item">{{el}}</li>
                            </ul>
                        </div>

                        <!-- è¾“å…¥æ¡†,æ–‡æœ¬åŸŸ -->
                        <textarea v-model="text_msg" class="form-control bg-transparent border-0 no-resize hide-scrollbar"
                                  placeholder="è™½ç„¶ä¸çŸ¥é“è¯´äº›ä»€ä¹ˆ, ä½†è¿˜æ˜¯è¯´ç‚¹ä»€ä¹ˆå§......" rows="1"></textarea>
                    </div>
                </div>

                <!-- å‘é€ä¿¡æ¯çš„æŒ‰é’® -->
                <div class="col-auto">
                    <div @click="sendMsgHandle" class="btn btn-primary btn-icon rounded-circle text-light mb-1" role="button">
                        <svg class="hw-24" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M14 5l7 7m0 0l-7 7m7-7H3" />
                        </svg>
                    </div>
                </div>
            </div>
        </form>
    </div>
</template>

<script>
    export default {
        name: "HomeChatFooter",

        //ä»çˆ¶ç»„ä»¶ä¸­å–ä¼ è¿‡æ¥çš„å€¼
        props:{
            currentUser:{
                type:Object
            }
        },

        //åŒå‘ç»‘å®šæ•°æ®
        data(){
            return{
                text_msg:'',
                emojiList: ['ğŸ˜€', 'ğŸ˜', 'ğŸ˜‚', 'ğŸ˜ƒ', 'ğŸ˜„', 'ğŸ˜…', 'ğŸ˜†', 'ğŸ˜‰', 'ğŸ˜Š', 'ğŸ˜‹', 'ğŸ˜', 'ğŸ˜', 'ğŸ˜˜', 'ğŸ˜—', 'ğŸ˜™', 'ğŸ˜š',
                    'ğŸ˜‡', 'ğŸ˜', 'ğŸ˜‘', 'ğŸ˜¶', 'ğŸ˜', 'ğŸ˜£', 'ğŸ˜¥', 'ğŸ˜®', 'ğŸ˜¯', 'ğŸ˜ª', 'ğŸ˜«', 'ğŸ˜´', 'ğŸ˜Œ', 'ğŸ˜›', 'ğŸ˜œ', 'ğŸ˜',
                    'ğŸ˜’', 'ğŸ˜“', 'ğŸ˜”', 'ğŸ˜•', 'ğŸ˜²', 'ğŸ˜·', 'ğŸ˜–', 'ğŸ˜', 'ğŸ˜Ÿ', 'ğŸ˜¤', 'ğŸ˜¢', 'ğŸ˜­', 'ğŸ˜¦', 'ğŸ˜§', 'ğŸ˜¨', 'ğŸ˜¬',
                    'ğŸ˜°', 'ğŸ˜±', 'ğŸ˜³', 'ğŸ˜µ', 'ğŸ˜¡', 'ğŸ˜ ', 'ğŸ’˜', 'â¤', 'ğŸ’“', 'ğŸ’”', 'ğŸ’•', 'ğŸ’–', 'ğŸ’—', 'ğŸ’™', 'ğŸ’š', 'ğŸ’›',
                    'ğŸ’œ', 'ğŸ’', 'ğŸ’', 'ğŸ’Ÿ', 'â£', 'ğŸ’ª', 'ğŸ‘ˆ', 'ğŸ‘‰', 'â˜', 'ğŸ‘†', 'ğŸ‘‡', 'âœŒ', 'âœ‹', 'ğŸ‘Œ', 'ğŸ‘', 'ğŸ‘', 'âœŠ', 'ğŸ‘Š',
                    'ğŸ‘‹', 'ğŸ‘', 'ğŸ‘', 'âœ', 'ğŸ‡', 'ğŸˆ', 'ğŸ‰', 'ğŸŠ', 'ğŸ‹', 'ğŸŒ', 'ğŸ', 'ğŸ', 'ğŸ', 'ğŸ', 'ğŸ‘', 'ğŸ’',
                    'ğŸ“', 'ğŸ…', 'ğŸ†', 'ğŸŒ½', 'ğŸ„', 'ğŸŒ°', 'ğŸ', 'ğŸ–', 'ğŸ—', 'ğŸ”', 'ğŸŸ', 'ğŸ•', 'ğŸ³', 'ğŸ²', 'ğŸ±', 'ğŸ˜',
                    'ğŸ™', 'ğŸš', 'ğŸ›', 'ğŸœ', 'ğŸ', 'ğŸ ', 'ğŸ¢', 'ğŸ£', 'ğŸ¤', 'ğŸ¥', 'ğŸ¡', 'ğŸ¦', 'ğŸ§', 'ğŸ¨', 'ğŸ©', 'ğŸª', 'ğŸ‚',
                    'ğŸ°', 'ğŸ«', 'ğŸ¬', 'ğŸ­', 'ğŸ®', 'ğŸ¯', 'ğŸ¼', 'â˜•', 'ğŸµ', 'ğŸ¶', 'ğŸ·', 'ğŸ¸', 'ğŸ¹', 'ğŸº', 'ğŸ»', 'ğŸ´', 'ğŸŒ¹', 'ğŸ€',
                    'ğŸ', 'ğŸ’°', 'ğŸ“±', 'ğŸŒ™', 'ğŸ', 'ğŸ‚', 'ğŸƒ', 'ğŸŒ·', 'ğŸ’', 'ğŸ”ª', 'ğŸ”«', 'ğŸ€', 'âš½', 'âš¡', 'ğŸ‘„', 'ğŸ‘', 'ğŸ”¥',
                    'ğŸ™ˆ', 'ğŸ™‰', 'ğŸ™Š', 'ğŸµ', 'ğŸ’', 'ğŸ¶', 'ğŸ•', 'ğŸ©', 'ğŸº', 'ğŸ±', 'ğŸ˜º', 'ğŸ˜¸', 'ğŸ˜¹', 'ğŸ˜»', 'ğŸ˜¼', 'ğŸ˜½', 'ğŸ™€',
                    'ğŸ˜¿', 'ğŸ˜¾', 'ğŸˆ', 'ğŸ¯', 'ğŸ…', 'ğŸ†', 'ğŸ´', 'ğŸ', 'ğŸ®', 'ğŸ‚', 'ğŸƒ', 'ğŸ„', 'ğŸ·', 'ğŸ–', 'ğŸ—', 'ğŸ½', 'ğŸ',
                    'ğŸ‘', 'ğŸ', 'ğŸª', 'ğŸ«', 'ğŸ˜', 'ğŸ­', 'ğŸ', 'ğŸ€', 'ğŸ¹', 'ğŸ°', 'ğŸ‡', 'ğŸ»', 'ğŸ¨', 'ğŸ¼', 'ğŸ¾', 'ğŸ”', 'ğŸ“',
                    'ğŸ£', 'ğŸ¤', 'ğŸ¥', 'ğŸ¦', 'ğŸ§', 'ğŸ¸', 'ğŸŠ', 'ğŸ¢', 'ğŸ', 'ğŸ²', 'ğŸ‰', 'ğŸ³', 'ğŸ‹', 'ğŸ¬', 'ğŸŸ', 'ğŸ ', 'ğŸ¡',
                    'ğŸ™', 'ğŸš', 'ğŸŒ', 'ğŸ›', 'ğŸœ', 'ğŸ', 'ğŸ', 'ğŸ¦‹', 'ğŸ˜ˆ', 'ğŸ‘¿', 'ğŸ‘¹', 'ğŸ‘º', 'ğŸ’€', 'â˜ ', 'ğŸ‘»', 'ğŸ‘½', 'ğŸ‘¾', 'ğŸ’£'],

                emojiShow:false, //æ§åˆ¶è¡¨æƒ…é¢æ¿çš„æ˜¾ç¤º
            }
        },
        //æ–¹æ³•
        methods:{
            //å‘é€æ¶ˆæ¯æŒ‰é’®äº‹ä»¶
            sendMsgHandle(){
                //alert(this.text_msg);

                //å°†å½“å‰ç”¨æˆ·ç›¸å…³ä¿¡æ¯ï¼šåŒ…æ‹¬éœ€è¦å‘é€çš„èŠå¤©æ¶ˆæ¯  ä¸€èµ·å‘å¾€åå°ï¼Œ
                // åå°å­˜å‚¨æ•°æ®åº“ï¼Œ
                // å‘ŠçŸ¥å‰å°åˆ·æ–°èŠå¤©ç»„ä»¶é¡µé¢ï¼Œ
                // å¹¶å¹¿æ’­ç»™å…¶ä»–åœ¨çº¿ç”¨æˆ·åˆ·æ–°èŠå¤©ç»„ä»¶é¡µé¢å†…å®¹
                this.$socket.emit('addGroupMsg',{
                    username:this.currentUser.username,
                    text_msg:this.text_msg,
                    chat_head:this.currentUser.chat_head
                });

                //å‘é€å®Œæ¶ˆæ¯ï¼Œè¾“å…¥æ¡†æ¸…ç©º
                this.text_msg = '';

            },
            //é€‰æ‹©è¡¨æƒ…äº‹ä»¶
            emojiSelectHandle(el){
                //å½“é€‰æ‹©å…·ä½“çš„è¡¨æƒ…æ—¶ï¼Œåº”è¯¥å°†è¡¨æƒ…å­—ç¬¦æ·»åŠ åˆ°è¾“å…¥æ¡†ä¸­
                this.text_msg += el;

                //é€‰æ‹©å®Œä¸€ä¸ªè¡¨æƒ…åå°†è¡¨æƒ…é¢æ¿æ˜¾ç¤ºæ ‡è®°ç½®false
                this.emojiShow = false;
            }
        }
    }
</script>

<style scoped>
    ul,
    li {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .chat-emoji {
        width: 550px;
        height: 336px;
        left: -26px;
        background: beige;
        position: absolute;
        top: -338px;
    }

    .chat-emoji::after {
        content: "";
        display: block;
        border: 10px solid transparent;
        border-bottom-color: beige;
        width: 0;
        position: absolute;
        z-index: -1;
        left: 67px;

        transform: rotate(180deg);
    }

    .emoji-list {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
    }

    .emoji-item {
        float: left;
        padding: 2px;
        cursor: pointer;
    }
</style>